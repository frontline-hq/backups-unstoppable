services:
  sftp:
    image: atmoz/sftp
    volumes:
      - ../vars/test/host_id_ed25519:/etc/ssh/ssh_host_ed25519_key:ro
      - ../vars/test/user_id_ed25519.pub:/home/sftpuser/.ssh/keys/id_ed25519.pub:ro
    command: "${SFTP_USER}::1001"
    networks:
      - test-net

  minio:
    image: minio/minio
    ports:
      - "9001:9001"
    command: server /data --console-address ":9001"
    networks:
      - test-net
  minio-waiter:
    image: busybox
    depends_on:
      - minio
    command: >
      /bin/sh -c "
        while ! nc -z minio 9000; do
          echo 'Waiting for Minio...';
          sleep 1;
        done;
        echo 'Minio is up!';
      "
networks:
  test-net:
    name: test-net-external
